\section{Theoretical Analysis} \label{section:theo}


\par In this section, a theoretical analysis of the circuit was conducted.

The circuit is divided in two different stages. The first one corresponds to the gain stage with a NPN transistor and a second output stage with a PNP transistor. Both the components and their functions will be described in Theoretical and Simulation Analysis as well as the goal of each stage.

\subsection{Gain Stage}
This stage is responsible for the amplification. This means it has to have a high gain. It also needs to have a high input voltage in order to avoid signal losses. Studying both operating point and incremental analysis it was possible to analyse this stage.
Simply analysing the circuit using KVL and KCL, it was obtained $Z_{i1}=R_B||r_{\pi 1}$ and $Z_{o1}=r_{o1}||R_c$. It is important to note that for low frequencies capacitors behave like open circuits and for high frequencies like short circuits as seen and studied in lab 2.

To analyse the incremental response we have to create a model of the transistor. Studying the circuit we get $v_{o1}=-g_m * (r_o||R_c) * v_{\pi}$ and $v_{\pi}= \frac{R_B||r_{\pi 1}}{R_B||r_{\pi 1}+R_s} * v_s $ which lead us to $A_{v1} = \frac{v_{o1}}{v_s} = -g_m * (r_o||R_c)*\frac{R_B||r_{\pi 1}}{R_B||r_{\pi 1}+R_s}$.


\subsection{Output Stage}

Considering that $Z_{o1}$ is too high it is needed a second stage to achieve a lower $Z_{o}$. 
For the DC response of the output stage, the same logic was followed and $Z_{i2}=\frac{(g_{m2}+g_{\pi 2}+g_{o2}+g_{E2})}{g_{\pi 2}(g_{\pi 2}+g_{o2}+g_{e2})}$ and $Z_{o2}= \frac{1}{(g_{m2}+g_{\pi2}+g_{o2}+g_{E2})}$ were obtained. To get the incremental response it was created another model. Using nodal analysis: $A_{v2} = \frac{v_{o2}}{v_{i2}} = \frac{g_{\pi} + g_{m2} }{g_{\pi 2}+g_{z2}+g_{o2}+g_{m2}}$.


\subsection{Final Results}


Finally, $i_o$ was calculated to then compute $Z_o=\frac{v_{o}}{i_o}=\frac{1}{g_{o2}+g_{m2}\frac{r_{\pi 2}}{r_{\pi 2}+Z_{o1}}+g_{e2}+\frac{1}{r_{\pi 2}+Z_{o1}}}$ using the provided equations. The gain is given by $A_V = A_{V1}*{AV2}$.

Low cutoff frequency was also computed using octave.
All the important results obtained are shown in the tables and in the figure bellow. As it can be seen there will not be a signal loss since $Z_{i2}>>Z_{o1}$.


\begin{table}[h!]
  \centering
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Value} \\ \hline
    \input{../mat/ponto1_tab} %../mat/
  \end{tabular}
  \caption{Operating point currents and Vcoll.}
  \label{tab:1}
\end{table}


\begin{table}[h!]
  \centering
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Value} \\ \hline
    \input{../mat/Z_tab} %../mat/
  \end{tabular}
  \caption{Impedences of both stages and of the full circuit.}
  \label{tab:2}
\end{table}

\vspace{3cm}

\begin{table}[h!]
  \centering
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Value} \\ \hline
    \input{../mat/r_theo_tab} %../mat/
  \end{tabular}
  \caption{Gain, bandwidth and cutoff frequency.}
  \label{tab:3}
\end{table}

\vspace{1cm}

\begin{figure}[h] \centering
\includegraphics[width=0.65\linewidth]{theo.eps}
\caption{Voltage Gain of the circuit computed in Octave}
\label{sh}
\end{figure}












